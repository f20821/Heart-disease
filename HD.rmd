```{r}
hd <- read.table("heart.disease.txt", header = FALSE, sep = ",")
colnames(hd) <- c("age", "sex", "cp", "trestbps", "chol", "fbs", "restecg", "thalach", "exang", "oldpeak", "slope", "ca", "thal", "status")
## status: "absenece" == 0, "presence" == 1-4
hd$status <- ifelse(hd$status == 0, "absence", "presence")
hd$status <- as.factor(hd$status)
```

```{r}
## 2 sex: (1 = male; 0 = female)
## 3 cp: chest pain type: 
##       Value 1: typical anging
##       Value 2: atypical angina
##       Value 3: non-anginal pain
##       Value 4: asymptomatic
## 4 trsetbps: resting blood pressure (mmHg)
## 5 chol: serum cholestoral in mg/dl
## 6 fbs: fasting blood sugar > 120 mg/dl (1 = true; 0 = false)
## 7 restecg: resting electrocardiographic results: 
##       Value 0: normal
##       Value 1: having ST-T wave abnormality (T wave inversions and/or ST elevation or depression of > 0.05 mV)
##       Value 2: showing probable or definite left ventricular hypertrophy by Estes' criteria
## 8 thalach: maximum heart rate achieved
## 9 exang: exercise induced angina (1 = yes; 0 = no)
##10 oldpeak: ST depression induced by exercise relative to rest
##11 slope: the slope of the peak exercise ST segment
##       Value 1: upsloping
##       Value 2: flat
##       Value 3: downsloping
##12 ca: number of major vessels (0-3) colored by flourosopy
##13 thal: 3 = normal; 6 = fixed defect; 7 = reversable defect
##14 status: diagnosis of heart disease (angiographic disease status)
##       Value 0: < 50% diameter narrowing
##       Value 1: > 50% diameter narrowing (in any major vessel: attributes 59 through 68 are vessels)
##  The "goal" field refers to the presence of heart disease in the patient. It is integer valued from 0 (no presence) to 4. Experiments with the Cleveland database have concentrated on simply attempting to distinguish presence (values 1,2,3,4) from absence (value 0).
```

## Missing Data
```{r}
## check if the data having missing value
table(hd == "?")
## turn missing value into NA
hd[hd == "?"] <- NA
## number of rows before removing the missing value
nrow(hd)
## number of rows left after removing the missing value
nrow(hd[complete.cases(hd), ])
## create new data (new_hd) without missing value
new_hd <- na.omit(hd)
```

## Data exploration
install.packages("ggplot2")

```{r}
library(ggplot2)
ggplot(new_hd, aes(x = status, fill = status)) + geom_bar()

## chol data
ggplot(new_hd, aes(x = chol)) + geom_histogram(bins = 20)
```

## component analysis (not successful)
```{r}
## principal component analysis
library(pcaGoPromoter)
library(ellipse)
##perform pca and extract scores
pcaOutput <- pca(t(new_hd[, -14]),printDropped = FALSE, scale = TRUE, center = TRUE)
pcaOutput2 <- as.data.frame(pcaOutput$scores)

##define groups for plotting
pcaOutput2$groups <- new_hd$status

centroids <- aggregate(cbind(PC1, PC2) ~groups, data = pcaOutput2, mean)

conf.rgn <- do.call(rbind, lapply(unique(pcaOutput2$groups), function(t)
  data.frame(groups = as.character(t),
             ellipse(cov(pcaOutput2[pcaOutput2$groups == t, 1:2]),
                     centre = as.matrix(centroids[centriods$groups == t, 2:3]),
                   level = 0.95),
             stringsAsFactors = FALSE)))

ggplot(data = pcaOutput2, aes(x = PC1, y = PC2, group = groups, color = groups)) + 
    geom_polygon(data = conf.rgn, aes(fill = groups), alpha = 0.2) +
    geom_point(size = 2, alpha = 0.6) + 
    scale_color_brewer(palette = "Set1") +
    labs(color = "",
         fill = "",
         x = paste0("PC1: ", round(pcaOutput$pov[1], digits = 2) * 100, "% variance"),
         y = paste0("PC2: ", round(pcaOutput$pov[2], digits = 2) * 100, "% variance")) 

```
